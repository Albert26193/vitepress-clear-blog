---
author: Albert
date: 2024-03-11
title: 计算机网络-HTTP1.1引入了哪些新特性
link: https://www.notion.so/HTTP1-1-4bf1ae3e8fde40cc9e3c23df2d4d9aa8
notionID: 4bf1ae3e-8fde-40cc-9e3c-23df2d4d9aa8
---

# 计算机网络-HTTP1.1引入了哪些新特性

> cite
>> cite again

我们在做 Video-UTR  的时候OpenAI o1/o3以及大火的DeepSeek还没有出来，但是当时组里的小伙伴在讨论的时候已经认识到了RL的重要性以及RL可能会引爆下一轮大模型的更新，所以就想着能不能从强化学习的视角来看video-langauge modeling，然后通过一系列实验观察我们发现了当前video mllm存在shortcut learning并意识到可以用reward hacking的理论来解释这一现象，就有了现在的Video-UTR，现在来看当时的预见还是比较准确的（有点马后炮哈哈哈哈）。当前这个阶段再来看Video-UTR这个工作感觉还是有很多可以进一步探索的方向，比如我们在文中提到的“建立一个合适代理reward是避免时间黑客的关键”，这同样也适用于当下以GRPO为代表的RL post-training，尤其是针对image以及video的诸多下游任务，如何优化设计reward是一个非常有价值的方向，这方面我们也会持续探索，敬请期待！

本文的核心内容是我们发现了导致视频大模型反缩放现象的根源在于一种“时间黑客”机制，时间黑客这一概念是我们从强化学习领域中“奖励黑客”（“reward hacking”，即一个智能体agent发现了一种在不实际实现任务设计者预期目标的情况下最大化其奖励信号的方法）这一定义引申而来的。简单来说，模型在处理视频时会走捷径，只关注某些关键帧，而忽略了整个视频的完整叙事。就像看电影只看开头和结尾，完全错过了中间的精彩情节。这种现象导致模型在视频理解任务中的表现越来越差，而且单纯增加数据量或模型参数根本无法解决这个问题，反而可能让情况更糟。当然为了更加严谨，我们还是从强化学习的角度严格定义这一现象。
> [!cite]
> [HTTP的三种身份认证：基本(Basic)认证、摘要(Digest)认证、基于表单(Form-Based)的SSL客户端认证 | 霍小强博客](https://www.huoxiaoqiang.com/experience/httpe/6451.html)

上篇　　秦孝公据崤函之固，拥雍州之地，君臣固守以窥周室，有席卷天下，包举宇内，囊括四海之意，并吞八荒之心。当是时也，商君佐之，内立法度，务耕织，修守战之具；外连衡而斗诸侯。于是秦人拱手而取西河之外。　　孝公既没，惠文、武、昭襄蒙故业，因遗策，南取汉中，西举巴蜀，东割膏腴之地，北收要害之郡。诸侯恐惧，会盟而谋弱秦，不爱珍器重宝肥饶之地，以致天下之士，合从缔交，相与为一。当此之时，齐有孟尝，赵有平原，楚有春申，魏有信陵。此四君者，皆明智而忠信，宽厚而爱人，尊贤而重士，约从离衡，兼韩、魏、燕、楚、齐、赵、宋、卫、中山之众。于是六国之士，有甯越、徐尚、苏秦、杜赫之属为之谋，齐明、周最、陈轸、召滑、楼缓、翟景、苏厉、乐毅之徒通其意，吴起、孙膑、带佗、倪良、王廖、田忌、廉颇、赵奢之伦制其兵。尝以十倍之地，百万之众，叩关而攻秦。秦人开关延敌，九国之师，逡巡而不敢进。秦无亡矢遗镞之费，而天下诸侯已困矣。于是从散约败，争割地而赂秦。秦有余力而制其弊，追亡逐北，伏尸百万，流血漂橹。因利乘便，宰割天下，分裂山河。强国请服，弱国入朝。延及孝文王、庄襄王，享国之日浅，国家无事。　　及至始皇，奋六世之余烈，振长策而御宇内，吞二周而亡诸侯，履至尊而制六合，执敲扑而鞭笞天下，威振四海。南取百越之地，以为桂林、象郡；百越之君，俯首系颈，委命下吏。乃使蒙恬北筑长城而守藩篱，却匈奴七百余里。胡人不敢南下而牧马，士不敢弯弓而报怨。于是废先王之道，焚百家之言，以愚黔首；隳名城，杀豪杰，收天下之兵，聚之咸阳，销锋镝，铸以为金人十二，以弱天下之民。然后践华为城，因河为池，据亿丈之城，临不测之渊，以为固。良将劲弩守要害之处，信臣精卒陈利兵而谁何。天下已定，始皇之心，自以为关中之固，金城千里，子孙帝王万世之业也。　　始皇既没，余威震于殊俗。然陈涉瓮牖绳枢之子，氓隶之人，而迁徙之徒也；才能不及中人，非有仲尼、墨翟之贤，陶朱、猗顿之富；蹑足行伍之间，而倔起阡陌之中，率疲弊之卒，将数百之众，转而攻秦，斩木为兵，揭竿为旗，天下云集响应，赢粮而景从。山东豪俊遂并起而亡秦族矣。　　且夫天下非小弱也，雍州之地，崤函之固，自若也。陈涉之位，非尊于齐、楚、燕、赵、韩、魏、宋、卫、中山之君也；锄櫌棘矜，非铦于钩戟长铩也；谪戍之众，非抗于九国之师也；深谋远虑，行军用兵之道，非及乡时之士也。然而成败异变，功业相反，何也？试使山东之国与陈涉度长絜大，比权量力，则不可同年而语矣。然秦以区区之地，致万乘之势，序八州而朝同列，百有余年矣；然后以六合为家，崤函为宫；一夫作难而七庙隳，身死人手，为天下笑者，何也？仁义不施而攻守之势异也。　　中篇　　秦灭周祀，并海内，兼诸侯，南面称帝，以养四海。天下之士，斐然向风。若是，何也？曰：近古之无王者久矣。周室卑微，五霸既灭，令不行于天下。是以诸侯力政，强凌弱，众暴寡，兵革不休，士民罢弊。今秦南面而王天下，是上有天子也。既元元之民冀得安其性命，莫不虚心而仰上。当此之时，专威定功，安危之本，在于此矣。　　秦王怀贪鄙之心，行自奋之智，不信功臣，不亲士民，废王道而立私爱，焚文书而酷刑法，先诈力而后仁义，以暴虐为天下始。夫兼并者高诈力，安危者贵顺权，此言取与守不同术也。秦离战国而王天下，其道不易，其政不改，是其所以取之守之者无异也。孤独而有之，故其亡可立而待也。借使秦王论上世之事，并殷、周之迹，以制御其政，后虽有淫骄之主，犹未有倾危之患也。故三王之建天下，名号显美，功业长久。　　今秦二世立，天下莫不引领而观其政。夫寒者利裋褐，而饥者甘糟糠。天下嚣嚣，新主之资也。此言劳民之易为仁也。向使二世有庸主之行而任忠贤，臣主一心而忧海内之患，缟素而正先帝之过；裂地分民以封功臣之后，建国立君以礼天下；虚囹圄而免刑戮，去收孥污秽之罪，使各反其乡里；发仓廪，散财币，以振孤独穷困之士；轻赋少事，以佐百姓之急；约法省刑，以持其后，使天下之人皆得自新，更节修行，各慎其身；塞万民之望，而以盛德与天下，天下息矣。即四海之内皆欢然各自安乐其处，惟恐有变。虽有狡害之民，无离上之心，则不轨之臣无以饰其智，而暴乱之奸弭矣。　　二世不行此术，而重以无道：坏宗庙与民，更始作阿房之宫；繁刑严诛，吏治刻深；赏罚不当，赋敛无度。天下多事，吏不能纪；百姓困穷，而主不收恤。然后奸伪并起，而上下相遁；蒙罪者众，刑戮相望于道，而天下苦之。自群卿以下至于众庶，人怀自危之心，亲处穷苦之实，咸不安其位，故易动也。是以陈涉不用汤、武之贤，不借公侯之尊，奋臂于大泽，而天下响应者，其民危也。　　故先王者，见终始之变，知存亡之由。是以牧民之道，务在安之而已矣。下虽有逆行之臣，必无响应之助。故曰：“安民可与为义，而危民易与为非”，此之谓也。贵为天子，富有四海，身在于戮者，正之非也。是二世之过也。　　下篇　　秦兼诸侯山东三十余郡，脩津关，据险塞，缮甲兵而守之。然陈涉率散乱之众数百，奋臂大呼，不用弓戟之兵，鉏耰白梃，望屋而食，横行天下。秦人阻险不守，关梁不闭，长戟不刺，强弩不射。楚师深入，战于鸿门，曾无藩篱之难。于是山东诸侯并起，豪俊相立。秦使章邯将而东征，章邯因其三军之众，要市于外，以谋其上。群臣之不相信，可见于此矣。子婴立，遂不悟。借使子婴有庸主之材而仅得中佐，山东虽乱，三秦之地可全而有，宗庙之祀宜未绝也。　　秦地被山带河以为固，四塞之国也。自缪公以来，至于秦王，二十余君，常为诸侯雄。此岂世贤哉？其势居然也。且天下尝同心并力攻秦矣，当此之世，贤智并列，良将行其师，贤相通其谋，然困于阻险而不能进，秦乃延入战而为之开关，百万之徒逃北而遂坏。岂勇力智慧不足哉？形不利，势不便也。秦小邑并大城，守险塞而军，高垒毋战，闭关据厄，荷戟而守之。诸侯起于匹夫，以利合，非有素王之行也。其交未亲，其下未附，名曰亡秦，其实利之也。彼见秦阻之难犯也，必退师。案土息民，以待其敝，收弱扶罢，以令大国之君，不患不得意于海内。贵为天子，富有四海，而身为禽者，其救败非也。　　秦王足己而不问，遂过而不变。二世受之，因而不改，暴虐以重祸。子婴孤立无亲，危弱无辅。三主之惑，终身不悟，亡不亦宜乎？当此时也，世非无深虑知化之士也，然所以不敢尽忠指过者，秦俗多忌讳之禁也，——忠言未卒于口而身糜没矣。故使天下之士倾耳而听，重足而立，阖口而不言。是以三主失道，而忠臣不谏，智士不谋也。天下已乱，奸不上闻，岂不悲哉！先王知壅蔽之伤国也，故置公卿、大夫、士，以饰法设刑而天下治。其强也，禁暴诛乱而天下服；其弱也，五伯征而诸侯从；其削也，内守外附而社稷存。故秦之盛也，繁法严刑而天下震；及其衰也，百姓怨而海内叛矣。故周王序得其道，千余载不绝；秦本末并失，故不能长。由是观之，安危之统相去远矣。　　鄙谚曰：“前事之不忘，后事之师也。”是以君子为国，观之上古，验之当世，参之人事，察盛衰之理，审权势之宜，去就有序，变化因时，故旷日长久而社稷安矣。——两汉·贾谊《过秦论》https://www.gushiwen.cn/shiwenv_21e30e31fefc.aspx


## 1. 持久连接

- [[../计算机网络-HTTP长连接和短连接|计算机网络-HTTP长连接和短连接]]
- 本质上就是**允许单个 `TCP` 连接上发送多个 `HTTP` 请求和响应，不必每次请求都单独创建新的连接。**
- `HTTP 1.1` 默认采取持久连接的方式。`HTTP1.0` 需要显式指定 `Connetction: keep-alive` 才能启用持久连接，但是 `HTTP1.1` 默认支持。*不必在头部指定，1.1 默认开启*。

## 2. 分块传输编码

- <mark>分块传输编码</mark>，允许服务器将响应分成一系列的数据块进行传输
- 本质的目的是能够实现*一边传输，一边解析*的效果
- 头部字段 `Transfer-Encoding: chunked`
- 每个分块，先利用 `16` 进制编码单独一行，说明当前分块的大小，便于后续计算偏移量。然后另起一行，表示当前传输的文本内容。

```txt
HTTP/1.1 200 OK
Content-Type: text/plain
Transfer-Encoding: chunked

25
This is the first chunk of data.
1A
This is the second chunk of data.
0

```

## 3. 身份验证机制（Authentication）的改进

### 3.1 `basic Authentication` 

![image.png](https://img-20221128.oss-cn-shanghai.aliyuncs.com/img-2023-05/20231023132844.png)

-  `http 1.0` 采用的身份认证的方式是 `basic authentication`。这种做法比较朴素，其内容如下 `demo` 所示。`Basic` 说明认证方式是 `basic`，后面的字符串是经过 `base64` 移位运算的字符串，里面的内容是具体的帐号和密码。

```http
GET /example HTTP/1.0
Host: example.com
Authorization: Basic dXNlcm5hbWU6cGFzc3dvcmQ=
```

- 如果客户端传输过来的验证没有通过，那么服务端就会发送一个头部包含 `WWW-Authenticate` 的消息，状态为 `401 Unauthorized`，让客户端重新认证。其内容如下所示。

```http
HTTP/1.0 401 Unauthorized
WWW-Authenticate: Basic realm="Restricted Area"
```

---

- `basic Authentication` 采用明文传输，对于各种类型的攻击都非常脆弱。

### 3.2 `Digest Authentication`

<!-- ![image.png](https://img-20221128.oss-cn-shanghai.aliyuncs.com/img-2023-05/20231023134059.png) -->

- 其具体流程如下：
1. 首先，客户端发起请求
2. 服务端响应的时候，在 `WWW-Authenticate` 头部字段当中，明确指定，认证方式为 `Digest Authentication`，同时，发送一个随机数`nonce` 和 对应的摘要算法。
3. 客户端对于该消息的响应包括两个部分，*必要认证参数，比如用户名/realm/nonce 等等* + *通过质询码计算出来的响应码(response)* 。所谓 `respoense`，就是通过 `md5` 或者其他摘要算法计算出来的哈希值。
4. 服务端会自己提前，用一样的算法，一样的参数，计算好*正确的响应码*，如果接收到客户端的*响应码和计算出来的相同*，那么，显然，客户端被认为是合法的，二者能够继续通信。
---
- 一定程度上**回避了明文传输的问题，但是依然非常不安全，弱点很多。**

## 4. 更加先进的缓存控制

- 引入新的 `HTTP` 头部，比如 `Etag/If-None-match/Cache-Control` 
- `ETag` 是一个标识符，通常用于表示资源的特定版本。这可能是一个哈希值，时间戳或其他标识符。**`ETag` 是一个响应头部字段，用于标识资源的特定版本。**
- `If-None-Match`: 是客户端发送的一个头部字段，**是请求头部**，通常包含先前从服务器收到的 `ETag` 值。如果 `ETag` 值与服务器上的资源版本匹配，服务器返回 `304 Not Modified`，告诉客户端其缓存版本仍然是最新的。[[../HTTP状态码/3系列状态码/计算机网络-HTTP304状态解读|计算机网络-HTTP304状态解读]]
- `Cache-Control`:这是一个非常重要的头部字段，允许细致控制资源在客户端（或中间缓存）上的缓存行为。常见的 Cache-Control 指令包括：
  - max-age=xxxseconds: 定义资源在被认为过期之前可以缓存多长时间。
    - test
      - test new
      - test again
        - new test
  - no-cache: 请求或响应不应直接使用缓存的版本，而应重新验证。
  - no-store: 禁止存储响应的任何版本。
  - private: 资源只能被客户端缓存，不能被中间缓存（例如 CDN）缓存。
  - public: 资源可以被任何缓存存储，即使它通常是不可缓存的或它有关联的 HTTP 认证。
  - must-revalidate: 一旦资源过期，缓存必须向服务器发送请求，验证资源是否仍然是新的。

## 5. 内容压缩

- [[计算机网络-HTTP1.1的内容编码]]

## 6. `SSE` 机制

- `server side event`
